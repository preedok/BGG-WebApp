/**
 * BINTANG GLOBAL - Constants
 * Sesuai Master Business Process
 */

// Workflow: Pusat + Koordinator per wilayah. Hotel/Bus/Invoice Saudi di Saudi Arabia.
const ROLES = {
  SUPER_ADMIN: 'super_admin',
  ADMIN_PUSAT: 'admin_pusat',
  // Koordinator per wilayah (menggantikan admin_cabang/admin_provinsi/admin_wilayah + role per cabang)
  ADMIN_KOORDINATOR: 'admin_koordinator',
  INVOICE_KOORDINATOR: 'invoice_koordinator',
  TIKET_KOORDINATOR: 'tiket_koordinator',
  VISA_KOORDINATOR: 'visa_koordinator',
  // Saudi Arabia: hotel, bus, invoice
  ROLE_HOTEL: 'role_hotel',
  ROLE_BUS: 'role_bus',
  ROLE_INVOICE_SAUDI: 'role_invoice_saudi',
  ROLE_ACCOUNTING: 'role_accounting',
  OWNER: 'owner',
  // Deprecated (tetap di enum DB untuk kompatibilitas, tidak dipakai)
  ADMIN_PROVINSI: 'admin_provinsi',
  ADMIN_WILAYAH: 'admin_wilayah',
  ADMIN_CABANG: 'admin_cabang',
  ROLE_INVOICE: 'role_invoice',
  ROLE_VISA: 'role_visa',
  ROLE_TICKET: 'role_ticket',
  ROLE_HANDLING: 'role_handling'
};

// PROSES A - Registrasi & Aktivasi Owner
const OWNER_STATUS = {
  REGISTERED_PENDING_MOU: 'registered_pending_mou',
  PENDING_MOU_APPROVAL: 'pending_mou_approval',
  PENDING_DEPOSIT_PAYMENT: 'pending_deposit_payment',
  PENDING_DEPOSIT_VERIFICATION: 'pending_deposit_verification',
  DEPOSIT_VERIFIED: 'deposit_verified',
  ASSIGNED_TO_BRANCH: 'assigned_to_branch',
  ACTIVE: 'active',
  REJECTED: 'rejected'
};

// IV. Status Invoice (Blueprint) - Lengkap
const INVOICE_STATUS = {
  DRAFT: 'draft',
  TENTATIVE: 'tentative',           // Tagihan DP - menunggu pembayaran DP
  PARTIAL_PAID: 'partial_paid',    // Pembayaran DP - DP sudah dibayar
  PAID: 'paid',                    // Lunas
  PROCESSING: 'processing',
  COMPLETED: 'completed',
  OVERDUE: 'overdue',
  CANCELED: 'canceled',
  REFUNDED: 'refunded',
  ORDER_UPDATED: 'order_updated',   // Order diupdate, invoice perlu penyesuaian
  OVERPAID: 'overpaid',             // Kelebihan bayar
  OVERPAID_TRANSFERRED: 'overpaid_transferred',  // Pindahan overpaid (sumber/dipindahkan)
  OVERPAID_RECEIVED: 'overpaid_received',        // Menerima pindahan overpaid
  REFUND_CANCELED: 'refund_canceled',            // Refund dibatalkan
  OVERPAID_REFUND_PENDING: 'overpaid_refund_pending'  // Kelebihan bayar - sisa pengembalian
};

// VII. Status Refund
const REFUND_STATUS = {
  REQUESTED: 'requested',
  APPROVED: 'approved',
  REJECTED: 'rejected',
  REFUNDED: 'refunded'
};

// VI. Hotel progress (Role Hotel)
const HOTEL_PROGRESS_STATUS = {
  WAITING_CONFIRMATION: 'waiting_confirmation',
  CONFIRMED: 'confirmed',
  ROOM_ASSIGNED: 'room_assigned',
  COMPLETED: 'completed'
};

const ROOM_STATUS = {
  AVAILABLE: 'available',
  BOOKED: 'booked',
  OCCUPIED: 'occupied'
};

// VI. Visa progress (Role Visa)
const VISA_PROGRESS_STATUS = {
  DOCUMENT_RECEIVED: 'document_received',
  SUBMITTED: 'submitted',
  IN_PROCESS: 'in_process',
  APPROVED: 'approved',
  ISSUED: 'issued'
};

// VI. Bus progress (Role Bus Saudi) - tiket bis, kedatangan, keberangkatan, kepulangan
const BUS_TICKET_STATUS = {
  PENDING: 'pending',
  ISSUED: 'issued'
};
const BUS_TRIP_STATUS = {
  PENDING: 'pending',
  SCHEDULED: 'scheduled',
  COMPLETED: 'completed'
};

// VI. Ticket progress (Role Tiket)
const TICKET_PROGRESS_STATUS = {
  PENDING: 'pending',
  DATA_RECEIVED: 'data_received',
  SEAT_RESERVED: 'seat_reserved',
  BOOKING: 'booking',
  PAYMENT_AIRLINE: 'payment_airline',
  TICKET_ISSUED: 'ticket_issued'
};

// Order item types
const ORDER_ITEM_TYPE = {
  HOTEL: 'hotel',
  VISA: 'visa',
  TICKET: 'ticket',
  BUS: 'bus',
  HANDLING: 'handling',
  PACKAGE: 'package'
};

// Room types for hotel (single, double, triple, quad, quint) â†’ kapasitas jamaah per kamar
const ROOM_TYPES = ['single', 'double', 'triple', 'quad', 'quint'];
const ROOM_CAPACITY = { single: 1, double: 2, triple: 3, quad: 4, quint: 5 };

// Order status (add blocked)
const ORDER_STATUS = {
  DRAFT: 'draft',
  TENTATIVE: 'tentative',
  CONFIRMED: 'confirmed',
  PROCESSING: 'processing',
  COMPLETED: 'completed',
  CANCELLED: 'cancelled',
  BLOCKED: 'blocked'
};

// Business rule keys (configurable by pusat / cabang)
const BUSINESS_RULE_KEYS = {
  BUS_MIN_PACK: 'bus_min_pack',
  BUS_PENALTY_IDR: 'bus_penalty_idr',
  HANDLING_DEFAULT_SAR: 'handling_default_sar',
  REQUIRE_HOTEL_WITH_VISA: 'require_hotel_with_visa',
  DP_GRACE_HOURS: 'dp_grace_hours',
  DP_DUE_DAYS: 'dp_due_days',
  CURRENCY_RATES: 'currency_rates',
  REGISTRATION_DEPOSIT_IDR: 'registration_deposit_idr',
  COMPANY_NAME: 'company_name',
  COMPANY_ADDRESS: 'company_address',
  NOTIFICATION_ORDER: 'notification_order',
  NOTIFICATION_PAYMENT: 'notification_payment',
  NOTIFICATION_INVOICE: 'notification_invoice',
  VISA_DEFAULT_IDR: 'visa_default_idr',
  TICKET_DEFAULT_IDR: 'ticket_default_idr',
  TICKET_GENERAL_IDR: 'ticket_general_idr',
  TICKET_LION_IDR: 'ticket_lion_idr',
  TICKET_SUPER_AIR_JET_IDR: 'ticket_super_air_jet_idr',
  TICKET_GARUDA_IDR: 'ticket_garuda_idr',
  MIN_DP_PERCENTAGE: 'min_dp_percentage',
  BANK_ACCOUNTS: 'bank_accounts'
};

// Notifikasi trigger (VIII)
const NOTIFICATION_TRIGGER = {
  INVOICE_CREATED: 'invoice_created',
  DP_RECEIVED: 'dp_received',
  OVERDUE: 'overdue',
  LUNAS: 'lunas',
  HOTEL_CONFIRMED: 'hotel_confirmed',
  VISA_ISSUED: 'visa_issued',
  TICKET_ISSUED: 'ticket_issued',
  ORDER_COMPLETED: 'order_completed',
  CANCEL: 'cancel',
  REFUND: 'refund',
  PAYROLL_SLIP_ISSUED: 'payroll_slip_issued'
};

// Payroll
const PAYROLL_METHOD = {
  SCHEDULED: 'scheduled',
  MANUAL: 'manual'
};

const PAYROLL_RUN_STATUS = {
  DRAFT: 'draft',
  PROCESSED: 'processed',
  FINALIZED: 'finalized'
};

// Accounting Document Workflow
const ACCOUNTING_DOC_STATUS = {
  DRAFT: 'draft',
  SUBMITTED: 'submitted',
  VERIFIED: 'verified',
  APPROVED: 'approved',
  POSTED_TO_GL: 'posted_to_gl',
  CLOSED: 'closed'
};

// Journal Entry Status
const JOURNAL_ENTRY_STATUS = {
  DRAFT: 'draft',
  SUBMITTED: 'submitted',
  APPROVED: 'approved',
  POSTED: 'posted',
  REVERSED: 'reversed'
};

// Account Types (Chart of Accounts)
const ACCOUNT_TYPE = {
  ASSET: 'asset',
  LIABILITY: 'liability',
  EQUITY: 'equity',
  REVENUE: 'revenue',
  EXPENSE: 'expense'
};

// Account Mapping Types
const ACCOUNT_MAPPING_TYPE = {
  SALES_HOTEL: 'sales_hotel',
  SALES_VISA: 'sales_visa',
  SALES_TICKET: 'sales_ticket',
  SALES_BUS: 'sales_bus',
  SALES_HANDLING: 'sales_handling',
  PURCHASE_HOTEL: 'purchase_hotel',
  PURCHASE_BUS: 'purchase_bus',
  PAYROLL: 'payroll',
  CASH_RECEIPT: 'cash_receipt',
  CASH_DISBURSEMENT: 'cash_disbursement',
  BANK_TRANSFER: 'bank_transfer'
};

// Business rules
const BUSINESS_RULES = {
  DP_PERCENTAGE_NORMAL: 30,
  DP_PERCENTAGE_SUPER_PROMO: 50,
  DP_GRACE_HOURS: 24,        // Invoice tentative batal jika belum DP dalam 24 jam
  DP_DUE_DAYS: 3,            // Tenggat DP 3 hari
  BUS_MIN_PACK: 35,
  CURRENCY: ['IDR', 'SAR'],
  REGISTRATION_DEPOSIT_IDR: 25000000,
  MIN_DP_PERCENTAGE: 30,
  BANK_ACCOUNTS: []  // [{ bank_name, account_number, account_name, currency? }]
};

module.exports = {
  ROLES,
  OWNER_STATUS,
  INVOICE_STATUS,
  REFUND_STATUS,
  ACCOUNTING_DOC_STATUS,
  JOURNAL_ENTRY_STATUS,
  ACCOUNT_TYPE,
  ACCOUNT_MAPPING_TYPE,
  HOTEL_PROGRESS_STATUS,
  ROOM_STATUS,
  BUS_TICKET_STATUS,
  BUS_TRIP_STATUS,
  VISA_PROGRESS_STATUS,
  TICKET_PROGRESS_STATUS,
  ORDER_ITEM_TYPE,
  ORDER_STATUS,
  ROOM_TYPES,
  ROOM_CAPACITY,
  BUSINESS_RULE_KEYS,
  NOTIFICATION_TRIGGER,
  BUSINESS_RULES,
  PAYROLL_METHOD,
  PAYROLL_RUN_STATUS
};
